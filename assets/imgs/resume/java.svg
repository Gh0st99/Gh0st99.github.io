<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="1318px" preserveAspectRatio="none" style="width:1702px;height:1318px;background:#FFFFFF;" version="1.1" viewBox="0 0 1702 1318" width="1702px" zoomAndPan="magnify"><defs><filter height="300%" id="f1ni3mz3yew32f" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#FEFECE" filter="url(#f1ni3mz3yew32f)" height="36.2969" rx="12.5" ry="12.5" style="stroke:#A80036;stroke-width:1.5;" width="46" x="654" y="640.2422"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="26" x="664" y="663.2373">Java</text><rect fill="#FEFECE" filter="url(#f1ni3mz3yew32f)" height="36.2969" rx="12.5" ry="12.5" style="stroke:#A80036;stroke-width:1.5;" width="96" x="750" y="640.2422"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="76" x="760" y="663.2373">并发 &amp; 同步</text><rect fill="#FEFECE" filter="url(#f1ni3mz3yew32f)" height="36.2969" rx="12.5" ry="12.5" style="stroke:#A80036;stroke-width:1.5;" width="182" x="896" y="20"/><a href="https://tech.meituan.com/2018/11/15/java-lock.html" target="_top" title="https://tech.meituan.com/2018/11/15/java-lock.html" xlink:actuate="onRequest" xlink:href="https://tech.meituan.com/2018/11/15/java-lock.html" xlink:show="new" xlink:title="https://tech.meituan.com/2018/11/15/java-lock.html" xlink:type="simple"><text fill="#0000FF" font-family="sans-serif" font-size="14" lengthAdjust="spacing" text-decoration="underline" textLength="61" x="906" y="42.9951">锁事-美团</text></a><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="93" x="971" y="42.9951">synchronized</text><a href="https://xiaomi-info.github.io/2020/03/24/synchronized/" target="_top" title="https://xiaomi-info.github.io/2020/03/24/synchronized/" xlink:actuate="onRequest" xlink:href="https://xiaomi-info.github.io/2020/03/24/synchronized/" xlink:show="new" xlink:title="https://xiaomi-info.github.io/2020/03/24/synchronized/" xlink:type="simple"><text fill="#0000FF" font-family="sans-serif" font-size="14" lengthAdjust="spacing" text-decoration="underline" textLength="61" x="1131" y="33.8467">原理-小米</text></a><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="126" x="1192" y="33.8467">，可重入性，可见性</text><path d="M1078,38.1484 L1088,38.1484 C1103,38.1484 1103,29 1118,29 L1128,29 " fill="none" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="42" x="1131" y="52.1436">锁升级</text><path d="M1078,38.1484 L1088,38.1484 C1103,38.1484 1103,47.2969 1118,47.2969 L1128,47.2969 " fill="none" style="stroke:#A80036;stroke-width:1.0;"/><path d="M846,658.3906 L856,658.3906 C871,658.3906 871,38.1484 886,38.1484 L896,38.1484 " fill="none" style="stroke:#A80036;stroke-width:1.0;"/><rect fill="#FEFECE" filter="url(#f1ni3mz3yew32f)" height="36.2969" rx="12.5" ry="12.5" style="stroke:#A80036;stroke-width:1.5;" width="67" x="896" y="76.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="47" x="906" y="99.292">volatile</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="42" x="1016" y="90.1436">可见性</text><path d="M963,94.4453 L973,94.4453 C988,94.4453 988,85.2969 1003,85.2969 L1013,85.2969 " fill="none" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="56" x="1016" y="108.4404">内存屏障</text><path d="M963,94.4453 L973,94.4453 C988,94.4453 988,103.5938 1003,103.5938 L1013,103.5938 " fill="none" style="stroke:#A80036;stroke-width:1.0;"/><path d="M846,658.3906 L856,658.3906 C871,658.3906 871,94.4453 886,94.4453 L896,94.4453 " fill="none" style="stroke:#A80036;stroke-width:1.0;"/><rect fill="#FEFECE" filter="url(#f1ni3mz3yew32f)" height="36.2969" rx="12.5" ry="12.5" style="stroke:#A80036;stroke-width:1.5;" width="34" x="896" y="568.4609"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="14" x="906" y="591.4561">锁</text><rect fill="#FEFECE" filter="url(#f1ni3mz3yew32f)" height="36.2969" rx="12.5" ry="12.5" style="stroke:#A80036;stroke-width:1.5;" width="62" x="980" y="314.1563"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="42" x="990" y="337.1514">锁升级</text><rect fill="#FEFECE" filter="url(#f1ni3mz3yew32f)" height="36.2969" rx="12.5" ry="12.5" style="stroke:#A80036;stroke-width:1.5;" width="62" x="1092" y="197.0781"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="42" x="1102" y="220.0732">偏向锁</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="140" x="1207" y="136.5889">一直被一个线程所访问</text><path d="M1154,215.2266 L1164,215.2266 C1179,215.2266 1179,131.7422 1194,131.7422 L1204,131.7422 " fill="none" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="14" x="1207" y="154.8857">在</text><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="85" x="1225" y="154.8857">Mark Word</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="126" x="1314" y="154.8857">里存储锁偏向的线程</text><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="15" x="1444" y="154.8857">ID</text><path d="M1154,215.2266 L1164,215.2266 C1179,215.2266 1179,150.0391 1194,150.0391 L1204,150.0391 " fill="none" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="0" x="1211" y="173.1826"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="28" x="1207" y="189.4795">撤销</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="14" x="1235" y="189.4795">：</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="238" x="1207" y="205.7764">只有遇到其他线程尝试竞争偏向锁时，</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="196" x="1207" y="222.0732">持有偏向锁的线程才会释放锁，</text><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="70" x="1207" y="238.3701">不会主动释</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="70" x="1277" y="238.3701">放偏向锁。</text><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="98" x="1207" y="254.667">等待全局安全点</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="168" x="1305" y="254.667">，暂停拥有偏向锁的线程，</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="210" x="1207" y="270.9639">判断锁对象是否处于被锁定状态。</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="380" x="1207" y="287.2607">恢复无锁（标志位为 01）或轻量级锁（标志位为 00）的状态</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="0" x="1211" y="303.5576"/><path d="M1154,215.2266 L1164,215.2266 C1179,215.2266 1179,233.5234 1194,233.5234 L1204,233.5234 " fill="none" style="stroke:#A80036;stroke-width:1.0;"/><path d="M1042,332.3047 L1052,332.3047 C1067,332.3047 1067,215.2266 1082,215.2266 L1092,215.2266 " fill="none" style="stroke:#A80036;stroke-width:1.0;"/><rect fill="#FEFECE" filter="url(#f1ni3mz3yew32f)" height="36.2969" rx="12.5" ry="12.5" style="stroke:#A80036;stroke-width:1.5;" width="76" x="1092" y="397.6406"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="56" x="1102" y="420.6357">轻量级锁</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="392" x="1221" y="321.8545">线程会通过自旋的形式尝试获取锁，不会阻塞，从而提高性能。</text><path d="M1168,415.7891 L1178,415.7891 C1193,415.7891 1193,317.0078 1208,317.0078 L1218,317.0078 " fill="none" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="0" x="1225" y="340.1514"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="61" x="1221" y="356.4482">无锁状态:</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="14" x="1221" y="372.7451">在</text><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="98" x="1235" y="372.7451">当前线程的栈帧</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="98" x="1333" y="372.7451">中建立一个名为</text><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="42" x="1431" y="372.7451">锁记录</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="170" x="1473" y="372.7451">（Lock Record）的空间，</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="140" x="1221" y="389.042">用于存储锁对象目前的</text><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="85" x="1365" y="389.042">Mark Word</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="56" x="1454" y="389.042">的拷贝，</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="126" x="1221" y="405.3389">然后拷贝对象头中的</text><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="85" x="1351" y="405.3389">Mark Word</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="112" x="1440" y="405.3389">复制到锁记录中。</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="144" x="1221" y="421.6357">CAS 操作尝试将对象的</text><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="85" x="1369" y="421.6357">Mark Word</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="0" x="1458" y="421.6357"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="28" x="1458" y="421.6357">更新</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="42" x="1486" y="421.6357">为指向</text><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="98" x="1532" y="421.6357">Lock Record</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="56" x="1634" y="421.6357">的指针，</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="28" x="1221" y="437.9326">并将</text><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="98" x="1253" y="437.9326">Lock Record</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="28" x="1355" y="437.9326">里的</text><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="51" x="1387" y="437.9326">owner</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="98" x="1442" y="437.9326">指针指向对象的</text><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="85" x="1544" y="437.9326">Mark Word</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="14" x="1629" y="437.9326">。</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="28" x="1221" y="454.2295">更新</text><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="28" x="1249" y="454.2295">成功</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="330" x="1277" y="454.2295">： 线程就拥有了该对象的锁，锁标志位设置为“00”。</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="28" x="1221" y="470.5264">更新</text><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="28" x="1249" y="470.5264">失败</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="169" x="1277" y="470.5264">： 对象的 Mark Word 是否</text><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="126" x="1446" y="470.5264">指向当前线程的栈帧</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="14" x="1572" y="470.5264">？</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="196" x="1221" y="486.8232">只有当前一个等待线程，自旋；</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="224" x="1221" y="503.1201">自旋超过次数，或来第三个，膨胀。</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="0" x="1225" y="519.417"/><path d="M1168,415.7891 L1178,415.7891 C1193,415.7891 1193,424.9375 1208,424.9375 L1218,424.9375 " fill="none" style="stroke:#A80036;stroke-width:1.0;"/><path d="M1042,332.3047 L1052,332.3047 C1067,332.3047 1067,415.7891 1082,415.7891 L1092,415.7891 " fill="none" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="98" x="1095" y="537.7139">重量级锁：管程</text><path d="M1042,332.3047 L1052,332.3047 C1067,332.3047 1067,532.8672 1082,532.8672 L1092,532.8672 " fill="none" style="stroke:#A80036;stroke-width:1.0;"/><path d="M930,586.6094 L940,586.6094 C955,586.6094 955,332.3047 970,332.3047 L980,332.3047 " fill="none" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="0" x="987" y="556.0107"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="28" x="983" y="572.3076">乐观</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="429" x="1011" y="572.3076">: 只是在更新数据的时候去判断之前有没有别的线程更新了这个数据，</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="322" x="983" y="588.6045">没有被更新，当前线程将自己修改的数据成功写入。</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="476" x="983" y="604.9014">已经被其他线程更新，则根据不同的实现方式执行不同的操作（报错或重试）</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="0" x="987" y="621.1982"/><path d="M930,586.6094 L940,586.6094 C955,586.6094 955,583.7578 970,583.7578 L980,583.7578 " fill="none" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="0" x="987" y="639.4951"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="28" x="983" y="655.792">悲观</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="279" x="1011" y="655.792">: 使用数据的时候一定有别的线程来修改数据,</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="172" x="983" y="672.0889">在获取数据的时候会先加锁,</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="196" x="983" y="688.3857">确保数据不会被别的线程修改。</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="0" x="987" y="704.6826"/><path d="M930,586.6094 L940,586.6094 C955,586.6094 955,667.2422 970,667.2422 L980,667.2422 " fill="none" style="stroke:#A80036;stroke-width:1.0;"/><rect fill="#FEFECE" filter="url(#f1ni3mz3yew32f)" height="36.2969" rx="12.5" ry="12.5" style="stroke:#A80036;stroke-width:1.5;" width="52" x="980" y="727.4297"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="32" x="990" y="750.4248">CAS</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="98" x="1085" y="722.9795">乐观锁中的重试</text><path d="M1032,745.5781 L1042,745.5781 C1057,745.5781 1057,718.1328 1072,718.1328 L1082,718.1328 " fill="none" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="60" x="1085" y="741.2764">ABA问题</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="190" x="1145" y="741.2764">: AtomicStampedReference</text><path d="M1032,745.5781 L1042,745.5781 C1057,745.5781 1057,736.4297 1072,736.4297 L1082,736.4297 " fill="none" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="210" x="1085" y="759.5732">只能保证一个共享变量的原子操作</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="128" x="1295" y="759.5732">: AtomicReference</text><path d="M1032,745.5781 L1042,745.5781 C1057,745.5781 1057,754.7266 1072,754.7266 L1082,754.7266 " fill="none" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="112" x="1085" y="777.8701">循环时间长开销大</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="219" x="1197" y="777.8701">: 只能保证一个共享变量的原子操作</text><path d="M1032,745.5781 L1042,745.5781 C1057,745.5781 1057,773.0234 1072,773.0234 L1082,773.0234 " fill="none" style="stroke:#A80036;stroke-width:1.0;"/><path d="M930,586.6094 L940,586.6094 C955,586.6094 955,745.5781 970,745.5781 L980,745.5781 " fill="none" style="stroke:#A80036;stroke-width:1.0;"/><rect fill="#FEFECE" filter="url(#f1ni3mz3yew32f)" height="36.2969" rx="12.5" ry="12.5" style="stroke:#A80036;stroke-width:1.5;" width="48" x="980" y="852.5078"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="28" x="990" y="875.5029">死锁</text><rect fill="#FEFECE" filter="url(#f1ni3mz3yew32f)" height="36.2969" rx="12.5" ry="12.5" style="stroke:#A80036;stroke-width:1.5;" width="76" x="1078" y="800.6172"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="56" x="1088" y="823.6123">产生条件</text><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="56" x="1207" y="796.167">互斥条件</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="238" x="1263" y="796.167">：一个资源每次只能被一个进程使用。</text><path d="M1154,818.7656 L1164,818.7656 C1179,818.7656 1179,791.3203 1194,791.3203 L1204,791.3203 " fill="none" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="70" x="1207" y="814.4639">占有且等待</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="378" x="1277" y="814.4639">：一个进程因请求资源而阻塞时，对已获得的资源保持不放。</text><path d="M1154,818.7656 L1164,818.7656 C1179,818.7656 1179,809.6172 1194,809.6172 L1204,809.6172 " fill="none" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="84" x="1207" y="832.7607">不可强行占有</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="345" x="1291" y="832.7607">: 进程已获得的资源，在末使用完之前，不能强行剥夺。</text><path d="M1154,818.7656 L1164,818.7656 C1179,818.7656 1179,827.9141 1194,827.9141 L1204,827.9141 " fill="none" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="84" x="1207" y="851.0576">循环等待条件</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="345" x="1291" y="851.0576">: 若干进程之间形成一种头尾相接的循环等待资源关系。</text><path d="M1154,818.7656 L1164,818.7656 C1179,818.7656 1179,846.2109 1194,846.2109 L1204,846.2109 " fill="none" style="stroke:#A80036;stroke-width:1.0;"/><path d="M1028,870.6563 L1038,870.6563 C1053,870.6563 1053,818.7656 1068,818.7656 L1078,818.7656 " fill="none" style="stroke:#A80036;stroke-width:1.0;"/><rect fill="#FEFECE" filter="url(#f1ni3mz3yew32f)" height="36.2969" rx="12.5" ry="12.5" style="stroke:#A80036;stroke-width:1.5;" width="48" x="1078" y="889.1016"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="28" x="1088" y="912.0967">排查</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="65" x="1179" y="869.3545">jstat $PID</text><path d="M1126,907.25 L1136,907.25 C1151,907.25 1151,864.5078 1166,864.5078 L1176,864.5078 " fill="none" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="157" x="1179" y="887.6514">jcmd $PID Thread.print</text><path d="M1126,907.25 L1136,907.25 C1151,907.25 1151,882.8047 1166,882.8047 L1176,882.8047 " fill="none" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="0" x="1183" y="905.9482"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="449" x="1179" y="922.2451">ThreadMXBean bean = ManagementFactory.getThreadMXBean()</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="343" x="1179" y="938.542">long[] threadIds = bean.findDeadlockedThreads()</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="0" x="1183" y="954.8389"/><path d="M1126,907.25 L1136,907.25 C1151,907.25 1151,925.5469 1166,925.5469 L1176,925.5469 " fill="none" style="stroke:#A80036;stroke-width:1.0;"/><path d="M1028,870.6563 L1038,870.6563 C1053,870.6563 1053,907.25 1068,907.25 L1078,907.25 " fill="none" style="stroke:#A80036;stroke-width:1.0;"/><path d="M930,586.6094 L940,586.6094 C955,586.6094 955,870.6563 970,870.6563 L980,870.6563 " fill="none" style="stroke:#A80036;stroke-width:1.0;"/><rect fill="#FEFECE" filter="url(#f1ni3mz3yew32f)" height="36.2969" rx="12.5" ry="12.5" style="stroke:#A80036;stroke-width:1.5;" width="112" x="980" y="986.7344"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="92" x="990" y="1009.7295">reentrantlock</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="224" x="1145" y="973.1357">实现原理，加锁和释放锁的一个过程</text><path d="M1092,1004.8828 L1102,1004.8828 C1117,1004.8828 1117,968.2891 1132,968.2891 L1142,968.2891 " fill="none" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="25" x="1145" y="991.4326">aqs</text><path d="M1092,1004.8828 L1102,1004.8828 C1117,1004.8828 1117,986.5859 1132,986.5859 L1142,986.5859 " fill="none" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="84" x="1145" y="1009.7295">公平和非公平</text><path d="M1092,1004.8828 L1102,1004.8828 C1117,1004.8828 1117,1004.8828 1132,1004.8828 L1142,1004.8828 " fill="none" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="42" x="1145" y="1028.0264">可重入</text><path d="M1092,1004.8828 L1102,1004.8828 C1117,1004.8828 1117,1023.1797 1132,1023.1797 L1142,1023.1797 " fill="none" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="42" x="1145" y="1046.3232">可中断</text><path d="M1092,1004.8828 L1102,1004.8828 C1117,1004.8828 1117,1041.4766 1132,1041.4766 L1142,1041.4766 " fill="none" style="stroke:#A80036;stroke-width:1.0;"/><path d="M930,586.6094 L940,586.6094 C955,586.6094 955,1004.8828 970,1004.8828 L980,1004.8828 " fill="none" style="stroke:#A80036;stroke-width:1.0;"/><path d="M846,658.3906 L856,658.3906 C871,658.3906 871,586.6094 886,586.6094 L896,586.6094 " fill="none" style="stroke:#A80036;stroke-width:1.0;"/><rect fill="#FEFECE" filter="url(#f1ni3mz3yew32f)" height="36.2969" rx="12.5" ry="12.5" style="stroke:#A80036;stroke-width:1.5;" width="90" x="896" y="1160.5547"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="70" x="906" y="1183.5498">并发工具类</text><rect fill="#FEFECE" filter="url(#f1ni3mz3yew32f)" height="36.2969" rx="12.5" ry="12.5" style="stroke:#A80036;stroke-width:1.5;" width="160" x="1036" y="1069.0703"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="140" x="1046" y="1092.0654">concurrenthashmap</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="126" x="1249" y="1064.6201">怎么保证线程安全的</text><path d="M1196,1087.2188 L1206,1087.2188 C1221,1087.2188 1221,1059.7734 1236,1059.7734 L1246,1059.7734 " fill="none" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="149" x="1249" y="1082.917">为什么用synchronized</text><path d="M1196,1087.2188 L1206,1087.2188 C1221,1087.2188 1221,1078.0703 1236,1078.0703 L1246,1078.0703 " fill="none" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="112" x="1249" y="1101.2139">分段锁有什么问题</text><path d="M1196,1087.2188 L1206,1087.2188 C1221,1087.2188 1221,1096.3672 1236,1096.3672 L1246,1096.3672 " fill="none" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="146" x="1249" y="1119.5107">hash算法做了哪些优化</text><path d="M1196,1087.2188 L1206,1087.2188 C1221,1087.2188 1221,1114.6641 1236,1114.6641 L1246,1114.6641 " fill="none" style="stroke:#A80036;stroke-width:1.0;"/><path d="M986,1178.7031 L996,1178.7031 C1011,1178.7031 1011,1087.2188 1026,1087.2188 L1036,1087.2188 " fill="none" style="stroke:#A80036;stroke-width:1.0;"/><rect fill="#FEFECE" filter="url(#f1ni3mz3yew32f)" height="36.2969" rx="12.5" ry="12.5" style="stroke:#A80036;stroke-width:1.5;" width="96" x="1036" y="1151.4063"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="76" x="1046" y="1174.4014">threadlocal</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="112" x="1185" y="1137.8076">什么场景下使用的</text><path d="M1132,1169.5547 L1142,1169.5547 C1157,1169.5547 1157,1132.9609 1172,1132.9609 L1182,1132.9609 " fill="none" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="28" x="1185" y="1156.1045">原理</text><path d="M1132,1169.5547 L1142,1169.5547 C1157,1169.5547 1157,1151.2578 1172,1151.2578 L1182,1151.2578 " fill="none" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="104" x="1185" y="1174.4014">hash冲突怎么办</text><path d="M1132,1169.5547 L1142,1169.5547 C1157,1169.5547 1157,1169.5547 1172,1169.5547 L1182,1169.5547 " fill="none" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="56" x="1185" y="1192.6982">扩容实现</text><path d="M1132,1169.5547 L1142,1169.5547 C1157,1169.5547 1157,1187.8516 1172,1187.8516 L1182,1187.8516 " fill="none" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="182" x="1185" y="1210.9951">内存泄漏产生原因，怎么解决</text><path d="M1132,1169.5547 L1142,1169.5547 C1157,1169.5547 1157,1206.1484 1172,1206.1484 L1182,1206.1484 " fill="none" style="stroke:#A80036;stroke-width:1.0;"/><path d="M986,1178.7031 L996,1178.7031 C1011,1178.7031 1011,1169.5547 1026,1169.5547 L1036,1169.5547 " fill="none" style="stroke:#A80036;stroke-width:1.0;"/><rect fill="#FEFECE" filter="url(#f1ni3mz3yew32f)" height="36.2969" rx="12.5" ry="12.5" style="stroke:#A80036;stroke-width:1.5;" width="62" x="1036" y="1242.8906"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="42" x="1046" y="1265.8857">线程池</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="28" x="1151" y="1229.292">原理</text><path d="M1098,1261.0391 L1108,1261.0391 C1123,1261.0391 1123,1224.4453 1138,1224.4453 L1148,1224.4453 " fill="none" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="56" x="1151" y="1247.5889">核心参数</text><path d="M1098,1261.0391 L1108,1261.0391 C1123,1261.0391 1123,1242.7422 1138,1242.7422 L1148,1242.7422 " fill="none" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="70" x="1151" y="1265.8857">线程数设置</text><path d="M1098,1261.0391 L1108,1261.0391 C1123,1261.0391 1123,1261.0391 1138,1261.0391 L1148,1261.0391 " fill="none" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="165" x="1151" y="1284.1826">参数动态调整后变化过程 *</text><path d="M1098,1261.0391 L1108,1261.0391 C1123,1261.0391 1123,1279.3359 1138,1279.3359 L1148,1279.3359 " fill="none" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="123" x="1151" y="1302.4795">线程抛异常怎么办 *</text><path d="M1098,1261.0391 L1108,1261.0391 C1123,1261.0391 1123,1297.6328 1138,1297.6328 L1148,1297.6328 " fill="none" style="stroke:#A80036;stroke-width:1.0;"/><path d="M986,1178.7031 L996,1178.7031 C1011,1178.7031 1011,1261.0391 1026,1261.0391 L1036,1261.0391 " fill="none" style="stroke:#A80036;stroke-width:1.0;"/><path d="M846,658.3906 L856,658.3906 C871,658.3906 871,1178.7031 886,1178.7031 L896,1178.7031 " fill="none" style="stroke:#A80036;stroke-width:1.0;"/><path d="M700,658.3906 L710,658.3906 C725,658.3906 725,658.3906 740,658.3906 L750,658.3906 " fill="none" style="stroke:#A80036;stroke-width:1.0;"/><rect fill="#FEFECE" filter="url(#f1ni3mz3yew32f)" height="36.2969" rx="12.5" ry="12.5" style="stroke:#A80036;stroke-width:1.5;" width="48" x="556" y="486.832"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="28" x="566" y="509.8271">线程</text><rect fill="#FEFECE" filter="url(#f1ni3mz3yew32f)" height="36.2969" rx="12.5" ry="12.5" style="stroke:#A80036;stroke-width:1.5;" width="76" x="430" y="486.832"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="56" x="440" y="509.8271">线程状态</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="32" x="345" y="398.6396">NEW</text><path d="M430,504.9805 L420,504.9805 C405,504.9805 405,393.793 390,393.793 L380,393.793 " fill="none" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="75" x="302" y="416.9365">RUNNABLE</text><path d="M430,504.9805 L420,504.9805 C405,504.9805 405,412.0898 390,412.0898 L380,412.0898 " fill="none" style="stroke:#A80036;stroke-width:1.0;"/><rect fill="#FEFECE" filter="url(#f1ni3mz3yew32f)" height="36.2969" rx="12.5" ry="12.5" style="stroke:#A80036;stroke-width:1.5;" width="87" x="293" y="431.2383"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="67" x="303" y="454.2334">BLOCKED</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="188" x="52" y="445.085">等待 montor lock 进入同步区</text><path d="M293,449.3867 L283,449.3867 C268,449.3867 268,440.2383 253,440.2383 L243,440.2383 " fill="none" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="230" x="10" y="463.3818">Object.wait() 后阻塞重新进入同步区</text><path d="M293,449.3867 L283,449.3867 C268,449.3867 268,458.5352 253,458.5352 L243,458.5352 " fill="none" style="stroke:#A80036;stroke-width:1.0;"/><path d="M430,504.9805 L420,504.9805 C405,504.9805 405,449.3867 390,449.3867 L380,449.3867 " fill="none" style="stroke:#A80036;stroke-width:1.0;"/><rect fill="#FEFECE" filter="url(#f1ni3mz3yew32f)" height="36.2969" rx="12.5" ry="12.5" style="stroke:#A80036;stroke-width:1.5;" width="78" x="302" y="487.5352"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="58" x="312" y="510.5303">WAITING</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="118" x="131" y="492.2334">无限 Object.wait()</text><path d="M302,505.6836 L292,505.6836 C277,505.6836 277,487.3867 262,487.3867 L252,487.3867 " fill="none" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="119" x="130" y="510.5303">无限 Thread.join()</text><path d="M302,505.6836 L292,505.6836 C277,505.6836 277,505.6836 262,505.6836 L252,505.6836 " fill="none" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="121" x="128" y="528.8271">LockSupport.park</text><path d="M302,505.6836 L292,505.6836 C277,505.6836 277,523.9805 262,523.9805 L252,523.9805 " fill="none" style="stroke:#A80036;stroke-width:1.0;"/><path d="M430,504.9805 L420,504.9805 C405,504.9805 405,505.6836 390,505.6836 L380,505.6836 " fill="none" style="stroke:#A80036;stroke-width:1.0;"/><rect fill="#FEFECE" filter="url(#f1ni3mz3yew32f)" height="36.2969" rx="12.5" ry="12.5" style="stroke:#A80036;stroke-width:1.5;" width="129" x="251" y="560.7227"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="109" x="261" y="583.7178">TIMED_WAITING</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="91" x="107" y="547.124">Thread.sleep</text><path d="M251,578.8711 L241,578.8711 C226,578.8711 226,542.2773 211,542.2773 L201,542.2773 " fill="none" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="118" x="80" y="565.4209">有限 Object.wait()</text><path d="M251,578.8711 L241,578.8711 C226,578.8711 226,560.5742 211,560.5742 L201,560.5742 " fill="none" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="119" x="79" y="583.7178">有限 Thread.join()</text><path d="M251,578.8711 L241,578.8711 C226,578.8711 226,578.8711 211,578.8711 L201,578.8711 " fill="none" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="165" x="33" y="602.0146">LockSupport.parkNanos</text><path d="M251,578.8711 L241,578.8711 C226,578.8711 226,597.168 211,597.168 L201,597.168 " fill="none" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="151" x="47" y="620.3115">LockSupport.parkUntil</text><path d="M251,578.8711 L241,578.8711 C226,578.8711 226,615.4648 211,615.4648 L201,615.4648 " fill="none" style="stroke:#A80036;stroke-width:1.0;"/><path d="M430,504.9805 L420,504.9805 C405,504.9805 405,578.8711 390,578.8711 L380,578.8711 " fill="none" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="91" x="286" y="621.0146">TERMINATED</text><path d="M430,504.9805 L420,504.9805 C405,504.9805 405,616.168 390,616.168 L380,616.168 " fill="none" style="stroke:#A80036;stroke-width:1.0;"/><path d="M556,504.9805 L546,504.9805 C531,504.9805 531,504.9805 516,504.9805 L506,504.9805 " fill="none" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="69" x="434" y="547.124">interrupt()</text><path d="M556,504.9805 L546,504.9805 C531,504.9805 531,542.2773 516,542.2773 L506,542.2773 " fill="none" style="stroke:#A80036;stroke-width:1.0;"/><path d="M654,658.3906 L644,658.3906 C629,658.3906 629,504.9805 614,504.9805 L604,504.9805 " fill="none" style="stroke:#A80036;stroke-width:1.0;"/><rect fill="#FEFECE" filter="url(#f1ni3mz3yew32f)" height="36.2969" rx="12.5" ry="12.5" style="stroke:#A80036;stroke-width:1.5;" width="48" x="556" y="676.1328"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="28" x="566" y="699.1279">集合</text><rect fill="#FEFECE" filter="url(#f1ni3mz3yew32f)" height="36.2969" rx="12.5" ry="12.5" style="stroke:#A80036;stroke-width:1.5;" width="84" x="422" y="652.9102"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="64" x="432" y="675.9053">hashmap</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="102" x="267" y="639.3115">原理, put &amp; get</text><path d="M422,671.0586 L412,671.0586 C397,671.0586 397,634.4648 382,634.4648 L372,634.4648 " fill="none" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="72" x="297" y="657.6084">8转红黑树?</text><path d="M422,671.0586 L412,671.0586 C397,671.0586 397,652.7617 382,652.7617 L372,652.7617 " fill="none" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="140" x="229" y="675.9053">什么时候扩容? 0.75？</text><path d="M422,671.0586 L412,671.0586 C397,671.0586 397,671.0586 382,671.0586 L372,671.0586 " fill="none" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="168" x="201" y="694.2021">扩容步骤，为什么分高低位</text><path d="M422,671.0586 L412,671.0586 C397,671.0586 397,689.3555 382,689.3555 L372,689.3555 " fill="none" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="238" x="127" y="712.499">头插法有什么问题，为什么线程不安全</text><path d="M422,671.0586 L412,671.0586 C397,671.0586 397,707.6523 382,707.6523 L372,707.6523 " fill="none" style="stroke:#A80036;stroke-width:1.0;"/><path d="M556,694.2813 L546,694.2813 C531,694.2813 531,671.0586 516,671.0586 L506,671.0586 " fill="none" style="stroke:#A80036;stroke-width:1.0;"/><rect fill="#FEFECE" filter="url(#f1ni3mz3yew32f)" height="36.2969" rx="12.5" ry="12.5" style="stroke:#A80036;stroke-width:1.5;" width="72" x="434" y="716.9492"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="52" x="444" y="739.9443">arraylist</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="103" x="278" y="730.7959">数组加transient</text><path d="M434,735.0977 L424,735.0977 C409,735.0977 409,725.9492 394,725.9492 L384,725.9492 " fill="none" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="56" x="325" y="749.0928">扩容原理</text><path d="M434,735.0977 L424,735.0977 C409,735.0977 409,744.2461 394,744.2461 L384,744.2461 " fill="none" style="stroke:#A80036;stroke-width:1.0;"/><path d="M556,694.2813 L546,694.2813 C531,694.2813 531,735.0977 516,735.0977 L506,735.0977 " fill="none" style="stroke:#A80036;stroke-width:1.0;"/><path d="M654,658.3906 L644,658.3906 C629,658.3906 629,694.2813 614,694.2813 L604,694.2813 " fill="none" style="stroke:#A80036;stroke-width:1.0;"/><rect fill="#FEFECE" filter="url(#f1ni3mz3yew32f)" height="36.2969" rx="12.5" ry="12.5" style="stroke:#A80036;stroke-width:1.5;" width="76" x="528" y="773.2461"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="56" x="538" y="796.2412">动态代理</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="273" x="202" y="787.0928">spring aop的理解，解决什么问题,实现原理</text><path d="M528,791.3945 L518,791.3945 C503,791.3945 503,782.2461 488,782.2461 L478,782.2461 " fill="none" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="196" x="279" y="805.3896">jdk动态代理,cglib区别，优缺点</text><path d="M528,791.3945 L518,791.3945 C503,791.3945 503,800.543 488,800.543 L478,800.543 " fill="none" style="stroke:#A80036;stroke-width:1.0;"/><path d="M654,658.3906 L644,658.3906 C629,658.3906 629,791.3945 614,791.3945 L604,791.3945 " fill="none" style="stroke:#A80036;stroke-width:1.0;"/><rect fill="#FEFECE" filter="url(#f1ni3mz3yew32f)" height="36.2969" rx="12.5" ry="12.5" style="stroke:#A80036;stroke-width:1.5;" width="48" x="556" y="829.543"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="28" x="566" y="852.5381">反射</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="28" x="475" y="852.5381">原理</text><path d="M556,847.6914 L546,847.6914 C531,847.6914 531,847.6914 516,847.6914 L506,847.6914 " fill="none" style="stroke:#A80036;stroke-width:1.0;"/><path d="M654,658.3906 L644,658.3906 C629,658.3906 629,847.6914 614,847.6914 L604,847.6914 " fill="none" style="stroke:#A80036;stroke-width:1.0;"/><rect fill="#FEFECE" filter="url(#f1ni3mz3yew32f)" height="36.2969" rx="12.5" ry="12.5" style="stroke:#A80036;stroke-width:1.5;" width="44" x="560" y="885.8398"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="24" x="570" y="908.835">NIO</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="56" x="451" y="890.5381">实现原理</text><path d="M560,903.9883 L550,903.9883 C535,903.9883 535,885.6914 520,885.6914 L510,885.6914 " fill="none" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="42" x="465" y="908.835">优缺点</text><path d="M560,903.9883 L550,903.9883 C535,903.9883 535,903.9883 520,903.9883 L510,903.9883 " fill="none" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="217" x="290" y="927.1318">netty的设计模型，架构，使用场景</text><path d="M560,903.9883 L550,903.9883 C535,903.9883 535,922.2852 520,922.2852 L510,922.2852 " fill="none" style="stroke:#A80036;stroke-width:1.0;"/><path d="M654,658.3906 L644,658.3906 C629,658.3906 629,903.9883 614,903.9883 L604,903.9883 " fill="none" style="stroke:#A80036;stroke-width:1.0;"/><!--MD5=[118825015a31cacf82cc3f6870cea759]
@startmindmap
* Java

** 并发 & 同步

*** [[https://tech.meituan.com/2018/11/15/java-lock.html 锁事-美团]] synchronized 
****_ [[https://xiaomi-info.github.io/2020/03/24/synchronized/ 原理-小米]]，可重入性，可见性
****_ 锁升级

*** volatile
****_ 可见性
****_ 内存屏障

*** 锁
**** 锁升级
***** 偏向锁
******_ 一直被一个线程所访问
******_ 在 **Mark Word** 里存储锁偏向的线程 **ID**
******_: 
**撤销**：
只有遇到其他线程尝试竞争偏向锁时，
持有偏向锁的线程才会释放锁，
**不会主动释**放偏向锁。
**等待全局安全点**，暂停拥有偏向锁的线程，
判断锁对象是否处于被锁定状态。
恢复无锁（标志位为 01）或轻量级锁（标志位为 00）的状态
;
***** 轻量级锁
******_ 线程会通过自旋的形式尝试获取锁，不会阻塞，从而提高性能。
******_: 
无锁状态: 
在**当前线程的栈帧**中建立一个名为**锁记录**（Lock Record）的空间，
用于存储锁对象目前的 **Mark Word** 的拷贝，
然后拷贝对象头中的 **Mark Word** 复制到锁记录中。
CAS 操作尝试将对象的 **Mark Word** **更新**为指向 **Lock Record** 的指针，
并将 **Lock Record** 里的 **owner** 指针指向对象的 **Mark Word**。
更新**成功**： 线程就拥有了该对象的锁，锁标志位设置为“00”。
更新**失败**： 对象的 Mark Word 是否**指向当前线程的栈帧**？
只有当前一个等待线程，自旋；
自旋超过次数，或来第三个，膨胀。
;
*****_ 重量级锁：管程

****_: 
**乐观**: 只是在更新数据的时候去判断之前有没有别的线程更新了这个数据，
没有被更新，当前线程将自己修改的数据成功写入。
已经被其他线程更新，则根据不同的实现方式执行不同的操作（报错或重试）
;
****_: 
**悲观**: 使用数据的时候一定有别的线程来修改数据,
在获取数据的时候会先加锁,
确保数据不会被别的线程修改。
;
**** **CAS**
*****_ 乐观锁中的重试
*****_ **ABA问题**: AtomicStampedReference
*****_ **只能保证一个共享变量的原子操作**: AtomicReference
*****_ **循环时间长开销大**: 只能保证一个共享变量的原子操作
**** 死锁
***** 产生条件
******_  **互斥条件**：一个资源每次只能被一个进程使用。
******_ **占有且等待**：一个进程因请求资源而阻塞时，对已获得的资源保持不放。
******_ **不可强行占有**: 进程已获得的资源，在末使用完之前，不能强行剥夺。
******_ **循环等待条件**: 若干进程之间形成一种头尾相接的循环等待资源关系。
***** 排查
******_ jstat $PID
******_ jcmd $PID Thread.print
******_:
ThreadMXBean bean = ManagementFactory.getThreadMXBean()
long[] threadIds = bean.findDeadlockedThreads()
;
**** reentrantlock
*****_ 实现原理，加锁和释放锁的一个过程
*****_ aqs
*****_ 公平和非公平
*****_ 可重入
*****_ 可中断

*** 并发工具类
**** concurrenthashmap
*****_ 怎么保证线程安全的
*****_ 为什么用synchronized
*****_ 分段锁有什么问题
*****_ hash算法做了哪些优化
**** threadlocal
*****_ 什么场景下使用的
*****_ 原理
*****_ hash冲突怎么办
*****_ 扩容实现
*****_ 内存泄漏产生原因，怎么解决
**** 线程池
*****_ 原理
*****_ 核心参数
*****_ 线程数设置
*****_ 参数动态调整后变化过程 *
*****_ 线程抛异常怎么办 *


left side

** 线程
*** 线程状态
****_ NEW
****_ RUNNABLE
**** BLOCKED
*****_ 等待 montor lock 进入同步区
*****_ Object.wait() 后阻塞重新进入同步区
**** WAITING
*****_ 无限 Object.wait()
*****_ 无限 Thread.join()
*****_ LockSupport.park
**** TIMED_WAITING
*****_ Thread.sleep
*****_ 有限 Object.wait()
*****_ 有限 Thread.join()
*****_ LockSupport.parkNanos
*****_ LockSupport.parkUntil
****_ TERMINATED

***_ interrupt()

** 集合

*** hashmap
****_ 原理, put & get
****_ 8转红黑树?
****_ 什么时候扩容? 0.75？
****_ 扩容步骤，为什么分高低位
****_ 头插法有什么问题，为什么线程不安全 

*** arraylist
****_ 数组加transient
****_ 扩容原理


** 动态代理
***_ spring aop的理解，解决什么问题,实现原理
***_ jdk动态代理,cglib区别，优缺点

** 反射
***_ 原理

** NIO
***_ 实现原理
***_ 优缺点
***_ netty的设计模型，架构，使用场景

@endmindmap

PlantUML version 1.2021.6(Fri May 14 07:09:51 UTC 2021)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: null
--></g></svg>